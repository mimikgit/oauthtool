{"version":3,"sources":["webpack:///webpack/bootstrap 511a21f061274c935778","webpack:///external \"electron\"","webpack:///external \"url\"","webpack:///./src/main/index.js","webpack:///external \"path\"","webpack:///external \"crypto\"","webpack:///external \"query-string\"","webpack:///external \"request-promise\"","webpack:///./config/env_production.json","webpack:///./src/menu/dev_menu_template.js","webpack:///./src/menu/edit_menu_template.js"],"names":["mainWindow","authWindow","devClientId","devRidirectUri","devEdgeIdToken","OAUTH_DOMAIN","SCOPES","RESET_SCOPES","base64URLEncode","str","toString","replace","verifier","crypto","randomBytes","sha256","buffer","createHash","update","digest","getProtocol","url","regex","match","data","protocol","host","hostname","port","pathname","search","hash","setApplicationMenu","menus","env","name","push","Menu","buildFromTemplate","createMainWindow","width","height","webPreferences","nativeWindowOpen","registerHttpProtocol","request","callback","_url","substr","length","query","queryString","parse","console","log","JSON","stringify","client_id","redirect_uri","edge_id_token","redirectProtocol","parseUrl","code","state","removeAllListeners","setImmediate","close","setTimeout","webContents","send","status","message","options","method","uri","form","grant_type","code_verifier","rp","then","parsedBody","token","session","defaultSession","cookies","get","error","optionsTokenExchange","access_token","tokenBody","userToken","edgeToken","scope","catch","id_token","err","error_description","oauthScope","reset","map","u","encodeURIComponent","join","redirect","parent","modal","nodeIntegration","loadURL","openDevTools","show","__dirname","on","focus","app","process","platform","quit","devMenuTemplate","label","submenu","accelerator","click","BrowserWindow","getFocusedWindow","reloadIgnoringCache","toggleDevTools","editMenuTemplate","selector","type"],"mappings":"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","file":"background.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 511a21f061274c935778","module.exports = require(\"electron\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"electron\"\n// module id = 0\n// module chunks = 0 1","module.exports = require(\"url\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"url\"\n// module id = 1\n// module chunks = 0","import { app, BrowserWindow, Menu, session, protocol, ipcRenderer, } from 'electron';\nimport * as path from 'path';\nimport { format as formatUrl } from 'url';\nimport * as URL from 'url';\nimport crypto from 'crypto';\nimport queryString from 'query-string';\nimport rp from 'request-promise';\n\nimport env from 'env';\n\nimport { devMenuTemplate } from '../menu/dev_menu_template';\nimport { editMenuTemplate } from '../menu/edit_menu_template';\n\n// global reference to mainWindow (necessary to prevent window from being garbage collected)\nlet mainWindow;\nlet authWindow;\nlet devClientId;\nlet devRidirectUri;\nlet devEdgeIdToken;\n\n\n\n////////////////////////////////////////////////\n\nconst OAUTH_DOMAIN = 'https://mid.mimik360.com';\nconst SCOPES = [\n      //  'write:me', \n      //  'read:users',\n      //  'read:friendList',\n      //  'delete:friend',        \n      //  'read:requestFriendList',\n      //  'read:friendRequestList',\n      //  'add:requestFriend',\n      //  'delete:requestFriend',\n      //  'update:friendRequest',\n      //  'delete:friendRequest',\n      //  'update:me',\n      //  'create:app',\n      //  'delete:app',\n      // 'read:me',\n       'edge:mcm',\n       'edge:clusters',\n       'edge:account:associate',\n       'openid', ];\n\nconst RESET_SCOPES = [\n        'openid',\n        'edge:account:unassociate',\n];\n\n///////////////////////////////////////////////\n\nfunction base64URLEncode(str) {\n  return str.toString('base64')\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=/g, '');\n}\n\nconst verifier = base64URLEncode(crypto.randomBytes(32));\n\nfunction sha256(buffer) {\n  return crypto.createHash('sha256').update(buffer).digest();\n}\n\nfunction getProtocol(url) {\n  if (typeof url === 'undefined' || url === null || url === '') {\n    return null;\n  }\n\n  const regex = /^(.+):\\/\\/(([^:/?#]*)(?::([0-9]+))?)([/]{0,1}[^?#]*)(\\?[^#]*|)(#.*|)$/;\n  const match = url.match(regex);\n  const data = match && {\n    url,\n    protocol: match[1],\n    host: match[2],\n    hostname: match[3],\n    port: match[4],\n    pathname: match[5],\n    search: match[6],\n    hash: match[7],\n  };\n  if (data.protocol) {\n    return data.protocol;\n  }\n  return null;\n}\n\nconst setApplicationMenu = () => {\n  const menus = [editMenuTemplate];\n  if (env.name !== 'production') {\n    menus.push(devMenuTemplate);\n  }\n  Menu.setApplicationMenu(Menu.buildFromTemplate(menus));\n};\n\nfunction createMainWindow() {\n  mainWindow = new BrowserWindow({\n    width: 1000,\n    height: 800,\n    webPreferences: {\n      nativeWindowOpen: true,\n    }\n  });\n\n  protocol.registerHttpProtocol('openid', (request, callback) => {\n    const _url = request.url.substr('openid://'.length);\n    const query = queryString.parse(_url.replace('callback?', ''));\n\n    console.log(`QUERY: ${JSON.stringify(query)}`);\n    \n\n    devClientId = query.client_id;\n    devRidirectUri = query.redirect_uri;\n    devEdgeIdToken = query.edge_id_token;\n    \n    // ejse.data('clientId', devClientId);\n\n    if (query.protocol) {\n      const redirectProtocol = getProtocol(devRidirectUri);\n      console.log(`redirectProtocol ${redirectProtocol}`);\n      \n      if (redirectProtocol) {\n        protocol.registerHttpProtocol(redirectProtocol, (request, callback) => {\n          const url = request.url.substr(12);\n          // const query = queryString.parse(url.replace('authorization_code?', ''));\n          const query = queryString.parseUrl(request.url);\n      \n          console.log(`url: ${url} ----- ${JSON.stringify(query)}`);\n          console.log(`code: ${query.query.code}, state: ${query.query.state}`);\n\n          authWindow.removeAllListeners('done');\n          setImmediate(() => {\n            authWindow.close();\n          });\n      \n          if (!query.query.code) {\n      \n            // const loginUrl = `file://${__dirname}/app.html`;\n      \n            // mainWindow.loadURL(loginUrl);\n      \n            setTimeout(() => {\n              mainWindow.webContents.send('oauth-login-reply', { status: false, message: query.query, devClientId, devRidirectUri });\n            }, 150);\n          } else {\n            var options = {\n              method: 'POST',\n              uri: `${OAUTH_DOMAIN}/token`,\n              form: {\n                grant_type: 'authorization_code',\n                code: query.query.code,\n                redirect_uri: devRidirectUri,\n                client_id: devClientId,\n                code_verifier: 'SqRg3wQWke2YSwMydkdilNHURfmmnt-Vlbvf8s2Ri58'\n              }\n            };\n        \n            rp(options)\n              .then((parsedBody) => {\n                const token = JSON.parse(parsedBody);\n\n                console.log(`rp: ${JSON.stringify(token, null, 2)}`);\n                session.defaultSession.cookies.get({}, (error, cookies) => {\n                  console.log(error, cookies)\n                });\n        \n                // const loginUrl = `file://${__dirname}/app.html`;\n        \n                // mainWindow.loadURL(loginUrl);\n\n                const optionsTokenExchange = {\n                  method: 'POST',\n                  uri: `${OAUTH_DOMAIN}/token`,\n                  form: {\n                    grant_type: 'exchange_edge_token',\n                    token: token.access_token,\n                    redirect_uri: devRidirectUri,\n                    code_verifier: 'SqRg3wQWke2YSwMydkdilNHURfmmnt-Vlbvf8s2Ri58',\n                    client_id: devClientId,\n                  },\n                };\n  \n                rp(optionsTokenExchange)\n                  .then((tokenBody) => {\n                    const userToken = JSON.parse(tokenBody).access_token;\n                    console.log(`accessToken: ${tokenBody} `);\n                    const data = {};\n                    data.userToken = userToken;\n                    data.edgeToken = token.access_token;\n                    // data.idToken = token.id_token;\n                    data.scope = token.scope;\n                    console.log(data);\n                    \n                  })\n                  .catch((error) => {\n                    console.error(JSON.stringify(error));\n                  });\n\n                if (token.id_token) {\n                  token.id_token = null;\n                }\n        \n                setTimeout(() => {\n                  mainWindow.webContents.send('oauth-login-reply', { status: true, token, devClientId, devRidirectUri });\n                }, 150);\n              })\n              .catch((err) => {\n                console.log(`${err}`);\n                // callback({path: path.normalize(`${__dirname}/error.html`)});\n                // const loginUrl = `file://${__dirname}/app.html`;\n        \n                // mainWindow.loadURL(loginUrl);\n        \n                setTimeout(() => {\n                  mainWindow.webContents.send('oauth-login-reply', { status: false, message: err, devClientId, devRidirectUri });\n                }, 150);\n              });\n          }\n      \n        }, (error) => {\n          if (error) {\n            console.error(`Failed to register protocol: ${redirectProtocol}`);\n            mainWindow.webContents.send('protocol-reply', { status: false, message: {error: 'Setup Redirect', error_description: 'Failed to register protocol'} });\n          } else {\n            console.error(`Registered protocol: ${redirectProtocol}`);\n            mainWindow.webContents.send('protocol-reply', { status: true, data: 'Setup Redirect done.' });\n          }\n        });\n      }\n    } else {\n      const oauthScope = query.reset ? \n        RESET_SCOPES.map(u => encodeURIComponent(u)).join('+') :\n        SCOPES.map(u => encodeURIComponent(u)).join('+');\n\n      const redirect = encodeURIComponent(devRidirectUri);\n      let url = `${OAUTH_DOMAIN}/auth?redirect_uri=${redirect}&scope=${oauthScope}&client_id=${devClientId}&state=xyz&response_type=code&code_challenge=czD7gtNh2SowYqxpN5OSf5a6wIiszEZ9AvRHGvwIJS4&code_challenge_method=S256`;\n\n      if (query.reset) {\n        url += `&edge_id_token=${devEdgeIdToken}`;\n      }\n      // mainWindow.loadURL(url);\n\n      authWindow = new BrowserWindow({\n        parent: mainWindow,\n        modal: true,\n        width: 1000,\n        height: 600,\n        webPreferences: {\n          nodeIntegration: false,\n        },\n      });\n\n      authWindow.loadURL(url);\n      if (env.name === 'development') {\n        authWindow.openDevTools();\n      }\n      authWindow.show();\n    }\n  });\n\n  mainWindow.loadURL(`file://${__dirname}/app.html`);\n\n  if (env.name === 'development') {\n    mainWindow.openDevTools();\n  }\n\n  mainWindow.on('closed', () => {\n    mainWindow = null\n  })\n\n  mainWindow.webContents.on('devtools-opened', () => {\n    mainWindow.focus()\n    setImmediate(() => {\n      mainWindow.focus()\n    })\n  })\n}\n\n// quit application when all windows are closed\napp.on('window-all-closed', () => {\n  // on macOS it is common for applications to stay open until the user explicitly quits\n  if (process.platform !== 'darwin') {\n    app.quit()\n  }\n})\n\napp.on('activate', () => {\n  // on macOS it is common to re-create a window even after all windows have been closed\n  if (mainWindow === null) {\n    createMainWindow()\n  }\n})\n\n// create main BrowserWindow when electron is ready\napp.on('ready', () => {\n  setApplicationMenu();\n  createMainWindow()\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main/index.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"query-string\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"query-string\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"request-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise\"\n// module id = 6\n// module chunks = 0","module.exports = {\"name\":\"production\",\"description\":\"Add here any environment specific stuff you like.\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./config/env_production.json\n// module id = 7\n// module chunks = 0","import { app, BrowserWindow } from \"electron\";\n\nexport const devMenuTemplate = {\n  label: \"Development\",\n  submenu: [\n    {\n      label: \"Reload\",\n      accelerator: \"CmdOrCtrl+R\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.reloadIgnoringCache();\n      }\n    },\n    {\n      label: \"Toggle DevTools\",\n      accelerator: \"Alt+CmdOrCtrl+I\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().toggleDevTools();\n      }\n    },\n    {\n      label: \"Quit\",\n      accelerator: \"CmdOrCtrl+Q\",\n      click: () => {\n        app.quit();\n      }\n    }\n  ]\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/menu/dev_menu_template.js","export const editMenuTemplate = {\n  label: \"Edit\",\n  submenu: [\n    { label: \"Undo\", accelerator: \"CmdOrCtrl+Z\", selector: \"undo:\" },\n    { label: \"Redo\", accelerator: \"Shift+CmdOrCtrl+Z\", selector: \"redo:\" },\n    { type: \"separator\" },\n    { label: \"Cut\", accelerator: \"CmdOrCtrl+X\", selector: \"cut:\" },\n    { label: \"Copy\", accelerator: \"CmdOrCtrl+C\", selector: \"copy:\" },\n    { label: \"Paste\", accelerator: \"CmdOrCtrl+V\", selector: \"paste:\" },\n    { label: \"Select All\", accelerator: \"CmdOrCtrl+A\", selector: \"selectAll:\" }\n  ]\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/menu/edit_menu_template.js"],"sourceRoot":""}